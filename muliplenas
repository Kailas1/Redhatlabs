- name: Mount multiple NFS shares temporarily if not already mounted
  hosts: all
  become: yes
  vars:
    nfs_shares:
      - { server: "172.25.250.10:/shared", mount_point: "/mnt/nas_share1/", owner_dir: "root", group_dir: "root" }
      - { server: "172.25.250.10:/shared2", mount_point: "/mnt/nas_share2/", owner_dir: "root", group_dir: "root" }
      # Add more shares as needed
  tasks:
    - name: Mount NFS shares
      block:
        - name: Check if NFS share is already mounted
          ansible.builtin.command: findmnt -n {{ item.mount_point }}
          register: mount_check
          ignore_errors: yes
          changed_when: false

        - name: Mount NFS share
          ansible.builtin.command: >
            mount -t nfs {{ item.server }} {{ item.mount_point }}
          when: mount_check.rc != 0
          register: mount_result

        - name: Show mount result
          ansible.builtin.debug:
            msg: "NFS share {{ item.server }} was mounted successfully to {{ item.mount_point }}"
          when: mount_check.rc != 0 and mount_result.rc == 0

        - name: Show already mounted message
          ansible.builtin.debug:
            msg: "NFS share {{ item.server }} is already mounted on {{ item.mount_point }}"
          when: mount_check.rc == 0
      loop: "{{ nfs_shares }}"
      loop_control:
        loop_var: item
